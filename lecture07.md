# 第7回課題

今、皆さんが作っている環境は、どんな攻撃にたいして「脆弱」ですか?どのような対策が取れそうですか?ぜひ考えてみてください。

### 脆弱性

#### 内容

- バグや設定不備によるWebアプリ・システムの「弱点・穴」。

#### 対策

- WEBサイトのSSL化を行い通信経路の暗号化を行う。

- Web アプリケーションにおいて通信経路の暗号化というのは必須事項であり、利用者と Web サーバ ーの間で通信を誰かにのぞき見されることは許されない。

### 認証情報

#### 内容

- 誤ってGithubなどにID・パスワード・アクセスキーなど公開してしまうとWeb攻撃者に不正利用される。

- 自分のAPIなどを不正利用され過剰なAPIコールにより過剰料金請求され「クラウド破産」という事態になる。

#### 対策

- AWS IAMを使用して、ユーザーには必要最小限の権限のみを付与すること。

- IAMユーザーやプログラム用のアクセスキーは定期的にローテーションさせることで、キーの漏洩を最小限に抑えること。

- 本番環境とテスト環境などを厳密に分離し、必要な人員だけが本番環境にアクセスできるようにする。

- EC2インスタンスやRDSデータベースなどのセキュリティグループを適切に設定し、不要なポートやアクセスを制限します。また、パブリックアクセスを必要最小限に制限すること。

- CloudTrailを有効化して、アカウント内で行われる操作を監視し、ログを記録することで、不正なアクティビティを検知しやすくします。

- AWS Billingで請求アラームを作成する。メールで請求アラームが発生した際は、利用しているAWSサービスの確認を行う。

### 人為的な過負荷

#### 内容

- 多数のコンピューターから連続でリクエストを送りWebサーバーの過負荷に耐えられずサービス停止に追い込まれる。

#### 対策
- DDoS攻撃と思われる通信を自動的に遮断するためにAWS ShieldとAWS WAF (Web Application Firewall)というサービスを使用する。

- AWS Autoscalingはリソースの需要に応じて自動的にスケーリングする機能をもっている。

- Elastic Load Balancing（ELB）を使用してトラフィックを分散し、アプリケーションの可用性を向上させることができます。AWS Autoscalingと連携してトラフィックを適切に分散することができます。

- 必要なリソースだけを利用することで、コストを最適化します。不必要なリソースの確保を避けることで、過剰な負荷を回避することができます。

- モニタリングとアラートにおいて、AWS CloudWatchやAWS Trusted Advisorなどを使用して、リソースの使用状況をモニタリングし、過負荷の兆候を早期に検知できるようにします。アラートを設定して、リソースの使用状況がしきい値を超えた際に通知を受け取ることも重要です。

## AWS セキュリティサービスメモ

### AWS Certificate Manager

AWS Certificate Manager(ACM)は、SSL 証明書を発行するマネージドサービスです。
ELB や CloudFront にアタッチすることができ、利用者と AWS サービス間の通信を暗号化し、のぞき見することを防ぐことが可能です。

### AWS Identity and Access Management（IAM）

IAMはAWSアカウントのアクセス管理を行うサービスで、ユーザー、グループ、ロールなどのアクセス権限を細かく設定・管理できます。最小特権の原則を適用し、ユーザーに必要な権限だけを与えることで、セキュリティを向上させます。

### AWS WAF（ウェブアプリケーションファイアウォール）
従来は専用装置で導入が必要だったものを 仮想化し、導入障壁を下げたものです。
AWS WAF ではルールを新規作成するか、 AWS やパートナーが提供するルールを使えます。ルールを ELB または CloudFrontに設置することで、クライアントのアクセスを必ず WAF が評価するように なります。

### AWS Shield

AWS ShieldはDDoS攻撃（分散型サービス拒否攻撃）からアプリケーションを保護するためのマネージド型のDDoS防御サービスです。AWS Shield Standardは全てのAWSユーザーに無償で提供されており、DDoS攻撃に対する基本的な保護を提供します。

### AWS Key Management Service（KMS）

KMSは暗号鍵を簡単に生成、管理、および保護するサービスです。KMSを使用することで、データを暗号化し、セキュリティを強化することができます。

### AWS CloudTrail

AWSアカウント内で行われるAPIアクティビティを記録・監視するためのサービスです。具体的には、AWSマネジメントコンソール、AWS CLI、AWS SDKなどを通じて発生した操作やリソースの変更に関する詳細なログを提供します。

1. アクションの記録: CloudTrailは、AWSアカウント内で発生するAPIアクション（例：EC2インスタンスの作成、S3バケットの作成、IAMユーザーの変更など）について、詳細なログを記録します。

2. ログの保持: CloudTrailは、アカウント内で行われたアクションのログを永続的に保持します。ログはAmazon S3バケットに保存されます。

3. 監査とセキュリティ: CloudTrailログは、アカウント内で行われた操作の監査やセキュリティインシデントの調査に役立ちます。誰が何を行ったのかを追跡できるため、コンプライアンス確保や不正アクティビティの検出に有用です。

4. イベント通知: CloudTrailは、特定のイベントが発生した場合に通知を受け取ることができるため、リアルタイムのアラートや監視が可能です。通知先としてAmazon SNSを使用することができます。

5. マルチアカウント対応: CloudTrailは、マルチアカウント環境でのログ収集もサポートしています。組織全体でのアクションの追跡とログの集中管理が可能です。


### AWS GuardDuty

AWSが提供するマネージド型のセキュリティサービスであり、不正行為やマルウェアの活動を検出するための監視サービスです。
従来はセキュリティのプロが確認していたような業務を AI に任せることで、低コストでサービスを提供しています。
GuardDutyは、AWSリソースのネットワークトラフィックやAPIアクティビティを自動的に監視し、異常なアクティビティを検知してアラートを発行します。

### Amazon Inspector

AWSが提供するセキュリティ評価サービスの1つであり、アプリケーションやインフラストラクチャのセキュリティ上の欠陥を自動的に検出し、評価することができるサービスです。Inspectorは、脆弱性のスキャンやセキュリティ違反の検出を行い、AWSアカウントのセキュリティリスクの低減をすることができる

### AWS Security Hub

AWSが提供する統合セキュリティサービスです。セキュリティ関連のアラートとコンプライアンス情報を一元管理し、セキュリティの可視性と自動化を強化することを目的としています。

1. マルチアカウントおよびマルチリージョンサポート：AWS Security Hubは、複数のAWSアカウントやリージョンでセキュリティの集中管理を可能にします。これにより、企業全体のセキュリティ状況を一元的に把握することができます。

2. 統合セキュリティチェック：AWS Security Hubは、AWSの様々なセキュリティサービス（例：Amazon GuardDuty、Amazon Inspector、AWS IAM Access Analyzerなど）からのセキュリティ関連のアラートを収集し、統合的に表示します。

3. カスタムインサイト：AWS Security Hubでは、セキュリティ関連のデータを分析してカスタムインサイトを作成できます。これにより、独自のセキュリティポリシーを設定して、特定のセキュリティ要件を満たすことが可能です。

4. コンプライアンス観点：AWS Security Hubは、セキュリティ規制やベストプラクティスに対するコンプライアンス情報を表示し、非準拠のリソースやセキュリティ上の問題を特定します。

5. 自動リアクション：セキュリティ上の重要なイベントや異常を検知すると、AWS Security HubはSNS（Amazon Simple Notification Service）トピックなどの他のAWSサービスと統合して、自動的なリアクションをトリガーできます。

AWS Security Hubを使用することで、セキュリティ関連のアラートを一元的に管理し、セキュリティリスクの低減やコンプライアンスの確保に役立てることができます。また、AWSの他のセキュリティサービスとの統合により、継続的なセキュリティモニタリングと対応が可能となります。

## 今回の課題から学んだこと

- AWSのログを収集するサービスを利用することで、AWS上のアプリケーションの挙動を把握し、セキュリティやトラブルシューティングに役立てることができる

- セキュリティチェックリストを作成し順守することでセキュリティリスクの軽減することができる

